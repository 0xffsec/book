<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Port Scanning Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.
Port scanners can be categorized between synchronous or connection-oriented and asynchronous or connectionless.
Synchronous scanners, like Nmap, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners."><meta property="og:title" content="Port Scanning"><meta property="og:description" content="Port Scanning Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.
Port scanners can be categorized between synchronous or connection-oriented and asynchronous or connectionless.
Synchronous scanners, like Nmap, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/notebook/discovery-and-scanning/port-scanning/"><meta property="article:modified_time" content="2020-05-05T15:10:05+02:00"><title>Port Scanning | Notebook</title><link rel=icon href=/notebook/favicon.png type=image/x-icon><link rel=stylesheet href=/notebook/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA+eA0kDHPqIYF+1eU="><script defer src=/notebook/en.search.min.457635315b65f9a19b2d6a6db4feec3c9142f38d815abf8e74f642197ffd3ee1.js integrity="sha256-RXY1MVtl+aGbLWpttP7sPJFC842BWr+OdPZCGX/9PuE="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/notebook><span>Notebook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Discovery and Scanning</span><ul><li><a href=/notebook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=/notebook/discovery-and-scanning/port-scanning/ class=active>Port Scanning</a></li></ul></li></ul><ul><li><a href=https://github.com/0xffsec/ target=_blank rel=noopener>Github</a></li><li><a href=https://0xffsec.com/ target=_blank rel=noopener>0xffsec.com</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notebook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Port Scanning</strong>
<label for=toc-control><img src=/notebook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#network-sweep>Network Sweep</a></li><li><a href=#host-scan>Host Scan</a><ul><li><a href=#tcp>TCP</a></li><li><a href=#udp>UDP</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></header><article class=markdown><h1 id=port-scanning>Port Scanning</h1><p>Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.<br>Port scanners can be categorized between <strong>synchronous or connection-oriented</strong> and <strong>asynchronous or connectionless</strong>.<br>Synchronous scanners, like <a href=https://nmap.org/>Nmap</a>, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners.<br>Asynchronous scanners like <a href=http://www.vulnerabilityassessment.co.uk/scanrand.htm>scanrad</a>, <a href=https://github.com/zmap/zmap>zmap</a>, or <a href=https://github.com/robertdavidgraham/masscan>masscan</a>, on the other hand, don&rsquo;t wait for a host response as they create separate threads for each port. This allows a high-speed scan, but less accurate since they cannot detect dropped packets.<br>Combining both tools could help you find a balance between speed and accuracy for each engagement. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=network-sweep>Network Sweep</h2><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo masscan -p 7,9,13,21-23,25-26,37,53,79-81,88,106,110-111,113,119,135,139,143-144,179,199,389,427,443-445,465,513-515,543-544,548,554,587,631,646,873,990,993,995,1025-1029,1110,1433,1720,1723,1755,1900,2000-2001,2049,2121,2717,3000,3128,3306,3389,3986,4899,5000,5009,5051,5060,5101,5190,5357,5432,5631,5666,5800,5900,6000-6001,6646,7070,8000,8008-8009,8080-8081,8443,8888,9100,9999-10000,32768,49152-49157 --rate <span style=color:#bd93f9>50000</span> --wait <span style=color:#bd93f9>0</span> --open-only -oG masscan.gnmap 10.0.0.0/24 
</code></pre></div><details><summary>Used masscan options</summary><ul><li><code>-p &lt;ports></code>: port(s) to be scanned.</li><li><code>--rate &lt;rate></code>: rate for transmitting packets (packet per seconds).</li><li><code>--wait &lt;seconds></code>: seconds after transmit is done to wait for receiving packets before exiting. Default 10 seconds.</li><li><code>--open-only</code>: report only open ports.</li><li><code>-oG &lt;filename></code>: output scan in grepable format to the given filename.</li></ul></details><h2 id=host-scan>Host Scan</h2><h3 id=tcp>TCP</h3><h4 id=fast-1000-ports-scan>Fast 1000 ports scan</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -v -sV -sC -O -T4 -n -Pn -oA nmap_scan 10.0.0.10
</code></pre></div><h4 id=fast-all-ports-scan>Fast all ports scan</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -v -sV -sC -O -T4 -n -Pn -p- -oA nmap_fullscan 10.0.0.10
</code></pre></div><h3 id=udp>UDP</h3><p>During a UDP scan (<code>-Su</code>) <code>-sV</code> will send protocol-specific probes, aka <em>nmap-service-probes</em>, to every <code>open|filtered</code> port. In case of response the state change to <code>open</code>. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -sU -sV --version-intensity <span style=color:#bd93f9>0</span> -n 10.0.0.0/24
</code></pre></div><details><summary>Used Nmap options</summary><ul><li><code>-v</code>: verbose mode.</li><li><code>-sU</code>: UDP scan.</li><li><code>-sV</code>: determine service/version info.</li><li><code>-sC</code>: performs a script scan.</li><li><code>-O</code>: enable OS detection.</li><li><code>-p &lt;port ranges></code>: scan specific ports.</li><li><code>--open</code>: only show open ports.</li><li><code>-Pn</code>: no ping.</li><li><code>-n</code>: no DNS resolution.</li><li><code>-T&lt;0-5></code>: timing template.</li><li><code>oX &lt;filename></code>: output scan in XML format to the given filename.</li><li><code>--version-intensity 0</code>: try only the probes most likely to be effective.</li></ul></details><h2 id=reference>Reference</h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Capt. Meelo. “Finding the Balance Between Speed & Accuracy During an Internet-Wide Port Scanning - Hack.Learn.Share.” Hack.Learn.Share, 29 July 2019, <a href=https://captmeelo.com/pentest/2019/07/29/port-scanning.html>https://captmeelo.com/pentest/2019/07/29/port-scanning.html</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“UDP Scan (-SU) | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, <a href=https://nmap.org/book/scan-methods-udp-scan.html>https://nmap.org/book/scan-methods-udp-scan.html</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/notebook/commit/09c5abe9e6ca9f65efc1f52eaaa298694e3dd106 title="Last modified by Max Rodrigo | May 5, 2020" target=_blank rel=noopener><img src=/notebook/svg/calendar.svg class=book-icon alt=Calendar>
<span>May 5, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/notebook/edit/master/content//discovery-and-scanning/port-scanning.md target=_blank rel=noopener><img src=/notebook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#network-sweep>Network Sweep</a></li><li><a href=#host-scan>Host Scan</a><ul><li><a href=#tcp>TCP</a></li><li><a href=#udp>UDP</a></li></ul></li><li><a href=#reference>Reference</a></li></ul></nav></aside></main></body></html>