<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Port Scanning Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.
Port scanners can be categorized between synchronous or connection-oriented and asynchronous or connectionless.
Synchronous scanners, like Nmap, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Port Scanning"><meta property="og:description" content="Port Scanning Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.
Port scanners can be categorized between synchronous or connection-oriented and asynchronous or connectionless.
Synchronous scanners, like Nmap, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/book/discovery-and-scanning/port-scanning/"><meta property="article:modified_time" content="2020-08-08T22:07:32+02:00"><title>Port Scanning | 0xffsec Penetration Testing Book</title><link rel=manifest href=/book/manifest.json><link rel=icon href=/book/favicon.png type=image/x-icon><link rel=stylesheet href=/book/book.min.57bbbeacd5a09f86500c98715e9090c679adaabd3284c4cc22218be87c7e4a56.css integrity="sha256-V7u+rNWgn4ZQDJhxXpCQxnmtqr0yhMTMIiGL6Hx+SlY="><script defer src=/book/en.search.min.891bf5a138d4221868abe7219019695ad06d3787284039c430090a0d6d741c92.js integrity="sha256-iRv1oTjUIhhoq+chkBlpWtBtN4coQDnEMAkKDW10HJI="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/book><span>0xffsec Penetration Testing Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/book/preface/>Preface</a></li><li><span>Discovery and Scanning</span><ul><li><a href=/book/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=/book/discovery-and-scanning/port-scanning/ class=active>Port Scanning</a></li></ul></li><li><a href=/book/exploits-search/>Exploits Search</a></li><li><a href=/book/brute-forcing/>Brute Forcing</a></li><li><a href=/book/services/>Services</a><ul><li><a href=/book/services/ftp/>FTP - 21</a></li><li><a href=/book/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=/book/services/dns/>DNS - 53</a></li><li><a href=/book/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=/book/services/pop/>POP - 110 / 995</a></li><li><a href=/book/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=/book/services/smb/>SMB - 139 / 445</a></li><li><a href=/book/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=/book/steganography/>Steganography</a></li><li><span>Web Applications</span><ul><li><a href=/book/web-applications/cgi/>CGI</a></li><li><a href=/book/web-applications/file-inclusion-and-path-traversal/>File Inclusion</a></li></ul></li><li><span>Shells</span><ul><li><a href=/book/shells/reverse-shells/>Reverse Shells</a></li><li><a href=/book/shells/restricted-shells/>Restricted Shells</a></li></ul></li><li><a href=/book/notes/ class=collapsed>Notes</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/book/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Port Scanning</strong>
<label for=toc-control><img src=/book/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#network-sweep>Network Sweep</a><ul><li><a href=#masscan-masscan>masscan</a></li></ul></li><li><a href=#host-scan>Host Scan</a><ul><li><a href=#tcp-scan>TCP Scan</a></li><li><a href=#udp-scan>UDP Scan</a></li><li><a href=#enumeration-scan>Enumeration Scan</a></li></ul></li><li><a href=#miscellaneous>Miscellaneous</a><ul><li><a href=#list-all-nmap-scripts-categories>List all Nmap scripts categories</a></li><li><a href=#list-nmap-scripts-for-a-specific-category>List Nmap scripts for a specific category</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=port-scanning>Port Scanning</h1><p>Let&rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.<br>Port scanners can be categorized between <strong>synchronous or connection-oriented</strong> and <strong>asynchronous or connectionless</strong>.<br>Synchronous scanners, like <a href=https://nmap.org/>Nmap</a>, wait for a host response (until the timeout period expires) to determine if the port it&rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners.<br>Asynchronous scanners like <a href=http://www.vulnerabilityassessment.co.uk/scanrand.htm>scanrad</a>, <a href=https://github.com/zmap/zmap>zmap</a>, or <a href=https://github.com/robertdavidgraham/masscan>masscan</a>, on the other hand, don&rsquo;t wait for a host response as they create separate threads for each port. This allows a high-speed scan, but less accurate since they cannot detect dropped packets.<br>Combining both tools could help you find a balance between speed and accuracy for each engagement. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=network-sweep>Network Sweep</h2><h3 id=masscan-masscan>masscan <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo masscan -p 7,9,13,21-23,25-26,37,53,79-81,88,106,110-111,113,119,135,139,143-144,179,199,389,427,443-445,465,513-515,543-544,548,554,587,631,646,873,990,993,995,1025-1029,1110,1433,1720,1723,1755,1900,2000-2001,2049,2121,2717,3000,3128,3306,3389,3986,4899,5000,5009,5051,5060,5101,5190,5357,5432,5631,5666,5800,5900,6000-6001,6646,7070,8000,8008-8009,8080-8081,8443,8888,9100,9999-10000,32768,49152-49157 --rate <span style=color:#3677a9>50000</span> --wait <span style=color:#3677a9>0</span> --open-only -oG masscan.gnmap 10.0.0.0/24 
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-p &lt;ports></code>: port(s) to be scanned.</li><li><code>--rate &lt;rate></code>: rate for transmitting packets (packet per seconds).</li><li><code>--wait &lt;seconds></code>: seconds after transmit is done to wait for receiving packets before exiting. Default 10 seconds.</li><li><code>--open-only</code>: report only open ports.</li><li><code>-oG &lt;filename></code>: output scan in grepable format to the given filename.</li></ul></div></details><h2 id=host-scan>Host Scan</h2><h3 id=tcp-scan>TCP Scan</h3><p>This is a good all-purpose initial scan. Scans the most common 1000 ports with service information (<code>-sV</code>), default scripts (<code>-sC</code>), and OS detection.</p><blockquote class="book-hint info">Verbose mode (<code>-v</code>) not only provides the estimated time for each host, but, it also prints the results as it goes letting you continue with the reconnaissance while scanning.</blockquote><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -v -sV -sC -O -T4 -n -Pn -oA nmap_scan 10.0.0.3
</code></pre></div><p>Similar scan but scans all ports, from 1 through 65535.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -v -sV -sC -O -T4 -n -Pn -p- -oA nmap_fullscan 10.0.0.3
</code></pre></div><h3 id=udp-scan>UDP Scan</h3><p>During a UDP scan (<code>-Su</code>) <code>-sV</code> will send protocol-specific probes, also known as <em>nmap-service-probes</em>, to every <code>open|filtered</code> port. In case of response the state change to <code>open</code>. <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -sU -sV --version-intensity <span style=color:#3677a9>0</span> -n 10.0.0.0/24
</code></pre></div><h3 id=enumeration-scan>Enumeration Scan</h3><p>In addition to the default scripts that run with <code>-sC</code> or <code>--script=default</code>, NSE (Nmap Scripting Engine), provides <a href=https://nmap.org/book/nse-usage.html#nse-script-selection>multiple types and categories</a> to select from.</p><p>It is a common practice to combine the list of ports resulting from a network sweep or a fast nmap scan like:</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -T4 -Pn -n 10.0.0.3
</code></pre></div><p>with a more extensive scan against those ports.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nmap -v -sV -O --script=<span style=color:#ed9d13>&#34;safe and vuln&#34;</span> -T4 -n -Pn -p135,445 -oA nmap_scan 10.0.0.3
</code></pre></div><p>The <code>--script</code> parameter is extremely flexible and full features, refer to the <a href=https://nmap.org/book/nse.html>documentation</a> for more about NSE.</p><blockquote class="book-hint danger">Never run scripts from third parties unless you trust the authors or have carefully audited the scripts yourself.</blockquote><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-v</code>: verbose mode.</li><li><code>-sU</code>: UDP scan.</li><li><code>-sV</code>: determine service/version info.</li><li><code>-sC</code>: performs a script scan.</li><li><code>-O</code>: enable OS detection.</li><li><code>-p &lt;port ranges></code>: scan specific ports.</li><li><code>--open</code>: only show open ports.</li><li><code>-Pn</code>: no ping.</li><li><code>-n</code>: no DNS resolution.</li><li><code>-T&lt;0-5></code>: timing template.</li><li><code>oX &lt;filename></code>: output scan in XML format to the given filename.</li><li><code>--version-intensity 0</code>: try only the probes most likely to be effective.</li></ul></div></details><h2 id=miscellaneous>Miscellaneous</h2><h3 id=list-all-nmap-scripts-categories>List all Nmap scripts categories</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>grep -r categories /usr/share/nmap/scripts/*.nse | grep -oP <span style=color:#ed9d13>&#39;&#34;.*?&#34;&#39;</span> | sort -u
</code></pre></div><h3 id=list-nmap-scripts-for-a-specific-category>List Nmap scripts for a specific category</h3><p>List scripts under the <code>default</code> category.</p><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>grep -r categories /usr/share/nmap/scripts/*.nse | grep default | cut -d: -f1
</code></pre></div><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Capt. Meelo. “Finding the Balance Between Speed & Accuracy During an Internet-Wide Port Scanning - Hack.Learn.Share.” Hack.Learn.Share, 29 July 2019, <a href=https://captmeelo.com/pentest/2019/07/29/port-scanning.html>https://captmeelo.com/pentest/2019/07/29/port-scanning.html</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Graham, Robert David. “GitHub - Robertdavidgraham/Masscan: TCP Port Scanner.” GitHub, <a href=https://github.com/robertdavidgraham/masscan>https://github.com/robertdavidgraham/masscan</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“UDP Scan (-SU) | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, <a href=https://nmap.org/book/scan-methods-udp-scan.html>https://nmap.org/book/scan-methods-udp-scan.html</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/book/commit/b9edfdfaadfa48e98dd78f660f5a29213d7a8cfb title="Last modified by Max Rodrigo | August 8, 2020" target=_blank rel=noopener><img src=/book/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 8, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/book/edit/master/content//discovery-and-scanning/port-scanning.md target=_blank rel=noopener><img src=/book/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#network-sweep>Network Sweep</a><ul><li><a href=#masscan-masscan>masscan</a></li></ul></li><li><a href=#host-scan>Host Scan</a><ul><li><a href=#tcp-scan>TCP Scan</a></li><li><a href=#udp-scan>UDP Scan</a></li><li><a href=#enumeration-scan>Enumeration Scan</a></li></ul></li><li><a href=#miscellaneous>Miscellaneous</a><ul><li><a href=#list-all-nmap-scripts-categories>List all Nmap scripts categories</a></li><li><a href=#list-nmap-scripts-for-a-specific-category>List Nmap scripts for a specific category</a></li></ul></li></ul></nav></aside></main></body></html>