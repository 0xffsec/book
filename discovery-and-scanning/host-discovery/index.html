<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Host Discovery One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal Passive Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications. The process does not generate any network traffic."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Host Discovery"><meta property="og:description" content="Host Discovery One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.
Internal Passive Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications. The process does not generate any network traffic."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/book/discovery-and-scanning/host-discovery/"><meta property="article:modified_time" content="2020-08-02T12:47:59+02:00"><title>Host Discovery | 0xffsec Penetration Testing Book</title><link rel=manifest href=/book/manifest.json><link rel=icon href=/book/favicon.png type=image/x-icon><link rel=stylesheet href=/book/book.min.6cd8553a6854f4812343f0f0c8baca31271e686434f381fbe3c7226f66639176.css integrity="sha256-bNhVOmhU9IEjQ/DwyLrKMSceaGQ084H748cib2ZjkXY="><script defer src=/book/en.search.min.5cf2f98ed801445b0718c5a86fa2f6462e2e5628d24d8886cc2e0e62d4873a6f.js integrity="sha256-XPL5jtgBRFsHGMWob6L2Ri4uVijSTYiGzC4OYtSHOm8="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/book><span>0xffsec Penetration Testing Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/book/preface/>Preface</a></li><li><span>Discovery and Scanning</span><ul><li><a href=/book/discovery-and-scanning/host-discovery/ class=active>Host Discovery</a></li><li><a href=/book/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=/book/exploits-search/>Exploits Search</a></li><li><a href=/book/services/>Services</a><ul><li><a href=/book/services/ftp/>FTP - 21</a></li><li><a href=/book/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=/book/services/dns/>DNS - 53</a></li><li><a href=/book/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=/book/services/pop/>POP - 110 / 995</a></li><li><a href=/book/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=/book/services/smb/>SMB - 139 / 445</a></li><li><a href=/book/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><span>Web Applications</span><ul><li><a href=/book/web-applications/cgi/>CGI</a></li><li><a href=/book/web-applications/file-inclusion-and-path-traversal/>File Inclusion</a></li></ul></li><li><span>Shells</span><ul><li><a href=/book/shells/reverse-shells/>Reverse Shells</a></li><li><a href=/book/shells/restricted-shells/>Restricted Shells</a></li></ul></li><li><a href=/book/notes/ class=collapsed>Notes</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/book/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Host Discovery</strong>
<label for=toc-control><img src=/book/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#internal>Internal</a><ul><li><a href=#passive>Passive</a></li><li><a href=#active>Active</a></li><li><a href=#icmp>ICMP</a></li></ul></li><li><a href=#external>External</a><ul><li><a href=#icmp-1>ICMP</a></li><li><a href=#port-discovery>Port Discovery</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=host-discovery>Host Discovery</h1><p>One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.</p><h2 id=internal>Internal</h2><h3 id=passive>Passive</h3><p>Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications. The process does not generate any network traffic.<br>Although is a slow process compared to an active scan and unreliable for service enumeration, as no packets are injected in the network, there is no risk of unintentional service disruption. Giving the advantage of being able to find intermittently offered or protected services that are often missed by active scanning. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h4 id=netdiscover---arp-netdiscover>netdiscover - ARP <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo netdiscover -p
</code></pre></div><ul><li><code>-p</code>: passive mode. It does not send anything, but <strong>does only sniff</strong>.</li></ul><h4 id=p0f---fingerprinting-p0f>p0f - Fingerprinting <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo p0f -p
</code></pre></div><ul><li><code>-p</code>: promiscuous mode; by default, it listens only to packet addressed or routed through.<br><strong>On IP-enabled interfaces can be detected remotely</strong>.</li></ul><h3 id=active>Active</h3><p>In contrast, active discovery does inject a variety of packets into the network, making it well suited for open port discovery and fingerprinting. However, these techniques are not without drawbacks. Scans can be invasive, generate too much noise and, in some cases cause service interruptions due to the type of packets that may be sent.</p><h4 id=netdiscover---arp-netdiscover-1>netdiscover - ARP <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo netdiscover -r 10.0.0.0/24
</code></pre></div><ul><li><code>-r &lt;range></code>: scan a given range instead of auto scan.</li></ul><h4 id=nmap>Nmap</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sn 10.0.0.0/24
</code></pre></div><ul><li><code>-sn</code>: No port scan AKA <strong>ping scan</strong>. <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>
Consists of an ICMP echo request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP timestamp request by default.</li></ul><h4 id=nbtscan---netbios-nbtscan>nbtscan - NetBIOS <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sudo nbtscan 10.0.0.0/24
</code></pre></div><h3 id=icmp>ICMP</h3><p>Refer to <a href=#icmp-1>External ICMP Scanning</a></p><h2 id=external>External</h2><h3 id=icmp-1>ICMP</h3><p>As defined in <a href=https://tools.ietf.org/html/rfc792>RFC 792</a>, ICMP messages are typically used for diagnostic or control purposes or generated in response to errors in IP operations (as specified in <a href=https://tools.ietf.org/html/rfc1122>RFC 1122</a>).<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup><br>Although it is possible to use ICMP requests to discover if a host is up or not, it is common to find all these packets being filtered, making it an unreliable method.</p><h4 id=ping>ping</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ping -c <span style=color:#3677a9>1</span> 10.0.0.3
</code></pre></div><ul><li><code>-c &lt;count></code>: stops after <code>count</code> replies.</li></ul><h4 id=fping-fping>fping <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup></h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>fping -g 10.0.0.0/24
</code></pre></div><ul><li><code>-g, --generate &lt;target></code>: generates target list. <code>target</code> can be start and end IP or a CIDR address.</li></ul><h4 id=nmap-1>Nmap</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -PEPM -sn -n 10.0.0.0/24
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-PE; -PP; -PM</code>: ICMP echo, timestamp, and netmask request discovery probes.</li><li><code>-sn</code>: No port scan.</li><li><code>-n</code>: No DNS resolution.</li></ul></div></details><h3 id=port-discovery>Port Discovery</h3><p>Another commonly used technique is port scanning. It allows you to identify running services, consequently, interesting hosts.
See <a href=https://0xffsec.com/book/discovery-and-scanning/port-scanning/>Port Scanning</a>.</p><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Whyte, David. Network Scanning Detection Strategies for Enterprise Networks. Sept. 2008, pp. 12-22 <a href=https://pdfs.semanticscholar.org/bb60/dc6cf24ea1f17126511e0998d3c55bdd50f9.pdf>https://pdfs.semanticscholar.org/bb60/dc6cf24ea1f17126511e0998d3c55bdd50f9.pdf</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“GitHub - Netdiscover-Scanner/Netdiscover: Netdiscover, ARP Scanner (Official Repository).” GitHub, <a href=https://github.com/netdiscover-scanner/netdiscover>https://github.com/netdiscover-scanner/netdiscover</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>Zalewski, Michal. “P0f V3.” [Lcamtuf.Coredump.Cx], <a href=https://lcamtuf.coredump.cx/p0f3/>https://lcamtuf.coredump.cx/p0f3/</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>“Host Discovery | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, <a href=https://nmap.org/book/man-host-discovery.html>https://nmap.org/book/man-host-discovery.html</a>. <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>“NETBIOS Nameserver Scanner.” Steve Friedl’s Home Page, <a href=http://www.unixwiz.net/tools/nbtscan.html>http://www.unixwiz.net/tools/nbtscan.html</a>. <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>Forouzan, Behrouz A. Data Communications and Networking. Huga Media, 2007, pp. 621–630. <a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7 role=doc-endnote><p>Schweikert, David. “Fping.” Fping Homepage, <a href=https://fping.org/>https://fping.org/</a>. <a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/book/commit/a9efa536674021ca5b229a04fde2232cd40a4a4b title="Last modified by Max Rodrigo | August 2, 2020" target=_blank rel=noopener><img src=/book/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 2, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/book/edit/master/content//discovery-and-scanning/host-discovery.md target=_blank rel=noopener><img src=/book/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#internal>Internal</a><ul><li><a href=#passive>Passive</a></li><li><a href=#active>Active</a></li><li><a href=#icmp>ICMP</a></li></ul></li><li><a href=#external>External</a><ul><li><a href=#icmp-1>ICMP</a></li><li><a href=#port-discovery>Port Discovery</a></li></ul></li></ul></nav></aside></main></body></html>