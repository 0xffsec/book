'use strict';(function(){const indexCfg={cache:true};indexCfg.doc={id:'id',field:['title','content'],store:['title','href'],};const index=FlexSearch.create('balance',indexCfg);window.bookSearchIndex=index;index.add({'id':0,'href':'/notebook/preface/','title':"Preface",'content':"Preface Conventions Typography italic\nIndicates URLs, email addresses, filenames, and file extensions.\nmonospaced\nFor programming listings, as well as within paragraphs to refer to program elements suck as variables or functions names, databases, data types, environment variables , statements, and keywords.\nbold monospaced\nCommands or other text that should be typed literally by the user.\nitalic monospaced\nText that should be replaced with user-supplied values or by values determined by context.\nHints This element signifies a tip or suggestion.  This element signifies a general note.  This element indicates a warning or caution.  Disclaimer Any actions and or activities related to the material contained within this Website are solely your responsibility. The misuse of the information on this website can result in criminal charges brought against the persons in question.\nThe authors will not be held responsible in the event any criminal charges be brought against any individuals misusing the information in this website to break the law.\n"});index.add({'id':1,'href':'/notebook/enumeration/ftp/','title':"FTP - 21",'content':"FTP is a standard network protocol used for the transfer of files between a client and a server on a computer network.\nFTP is built on a client-server architecture using separate control and data connections between the client and the server. FTP authenticates users with a clear-text sign-in protocol, normally in the form of a username and password, but can connect anonymously if the server is configured to allow it. 1\nBanner Grabbing Telnet telnet 10.0.0.3 21 Netcat nc -n 10.0.0.3 21 Nmap nmap -sV -script=banner -p21 -Pn 10.0.0.3 FTP ftp 10.0.0.3 FTP Exploits Search Refer to Exploits Search\nAnonymous Login During the port scanning phase Nmap\u0026rsquo;s script scan (-sC), can be enabled to check for FTP Bounce and Anonymous Login.  Try anonymous login using anonymous:anonymous credentials.\nftp 10.0.0.3 … Name (10.0.0.3:kali): anonymous 331 Please specify the password. Password: [anonymous] 230 Login successful. List all files in order.\nftp\u0026gt; ls -lat 200 PORT command successful. Consider using PASV. 150 Here comes the directory listing. … 226 Directory send OK. FTP Browser Client Due to its insecure nature, FTP support is being dropped by Firefox and Google Chrome.  Try accessing ftp://user:pass@10.0.0.3 from your browser.\nIf not credentials provided anonymous:anonymous is assumed.\nBrute Forcing As an alternative to profiled passwords, Daniel Miessler\u0026rsquo;s SecLists includes a handy list of FTP default credentials.\nHydra 2 Using a colon-separated user:pass list.\nhydra -v -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt -f 10.0.0.3 ftp Using login user and passwords list.\nhydra -v -l ftp -P /usr/share/wordlists/rockyou.txt.gz -f 10.0.0.3 ftp   Parameters   -v: verbose mode. -C \u0026lt;user:pass file\u0026gt;: colon-separated \u0026ldquo;login:pass\u0026rdquo; format. -l \u0026lt;user\u0026gt;: login with user name. -P \u0026lt;passwords file\u0026gt;: login with password from file. -f: exit after the first found user/password pair.   Medusa 3 Medusa\u0026rsquo;s combo files (colon-separated) should be in the format host:username:password. If any of the three values are missing, the respective information should be provided either as a global value or as a list in a file.\nsed s/^/:/ /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt \u0026gt; /tmp/cplist.txt medusa -C /tmp/cplist.txt -h 10.0.0.3 -M ft Using login user and passwords list.\nmedusa -u ftp -P /usr/share/wordlists/rockyou.txt -h 10.0.0.3 -M ftp   Parameters   -u \u0026lt;user\u0026gt;: login with user name. -P \u0026lt;passwords file\u0026gt;: login with password from file. -h: target hostname or IP address. -M: module to execute.   Configuration files Examine configuration files.4\nftpusers ftp.conf proftpd.conf Miscellaneous Binary and ASCII Binary and ASCII files have to be uploading using the binary or ascii mode respectively, otherwise, the file will become corrupted. Use the corresponding command to switch between modes.5\nRecursively Download Recursively download FTP folder content.6\nwget -m ftp://user:pass@10.0.0.3/ Reference   Contributors to Wikimedia projects. “File Transfer Protocol - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 24 May 2002, https://en.wikipedia.org/wiki/File_Transfer_Protocol. \u0026#x21a9;\u0026#xfe0e;\n Heuse, Marc. “GitHub - Vanhauser-Thc/Thc-Hydra: Hydra.” GitHub, https://github.com/vanhauser-thc/thc-hydra. Accessed 12 May 2020. \u0026#x21a9;\u0026#xfe0e;\n “Foofus Networking Services - Medusa.” Foofus.Net | Foofus.Net Advanced Security Services Forum, http://foofus.net/goons/jmk/medusa/medusa.html. \u0026#x21a9;\u0026#xfe0e;\n “Penetration Testing Methodology” 0DAYsecurity.Com, http://www.0daysecurity.com/penetration-testing/enumeration.html. \u0026#x21a9;\u0026#xfe0e;\n “RFC959: FTP: Data Transfer Functions.” World Wide Web Consortium (W3C), https://www.w3.org/Protocols/rfc959/3_DataTransfer.html. \u0026#x21a9;\u0026#xfe0e;\n Thibaut Barrère. “Command Line - How to Recursively Download a Folder via FTP on Linux - Stack Overflow.” Stack Overflow, https://stackoverflow.com/a/113900/578050. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':2,'href':'/notebook/enumeration/http-https/','title':"HTTP/S - 80 / 443",'content':"Directory Enumeration As a first step, while we browse the web/application, it is a good idea to do some files and directories enumeration, look for unlinked content, temporary directories, and backups.\nWidely used tools include dirbuster, gobuster, dirb and the suite Burp.\nWordlists Included in Kali\u0026rsquo;s wordlists package.\n dirbuster\u0026rsquo;s medium 2.3.\n/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt dirb common.\n/usr/share/wordlists/dirb/common.txt dirb big.\n/usr/share/wordlists/dirb/common.txt  Not included in Kali.\n  Jhaddix\u0026rsquo;s content_discovery_all.\nhttps://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10\n  Daniel Miessler\u0026rsquo;s Robots Disallowed and SecLists (Includes the former one).\n/usr/share/seclists/Discovery/Web-Content/common.txt\n/usr/share/seclists/Discovery/Web-Content/RobotsDisallowed-Top1000.txt\n  gobuster 1 gobuster dir -t 30 -k -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u https://10.0.0.3/   Parameters   dir: directory brute-forcing mode. -t \u0026lt;n\u0026gt;: number of concurrent threads (default 10). -k: skip SSL certificate verification. -w \u0026lt;wordlist\u0026gt;: path to the wordlist. -u \u0026lt;URL\u0026gt;: target URL.   dirb 2 dirb https://10.0.0.3/ /usr/share/seclists/Discovery/Web-Content/common.txt Reference   Reeves, OJ. “GitHub - OJ/Gobuster.” GitHub, https://github.com/OJ/gobuster. \u0026#x21a9;\u0026#xfe0e;\n Pinuaga, Ramon. “DIRB .” DIRB Homepage, http://dirb.sourceforge.net/. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':3,'href':'/notebook/discovery-and-scanning/','title':"Discovery and Scanning",'content':""});index.add({'id':4,'href':'/notebook/discovery-and-scanning/host-discovery/','title':"Host Discovery",'content':"Host Discovery One of the first steps during the network enumeration is to reduce a set of IPs into a list of active or interesting hosts. Depending on if you are inside the network or scanning remotely, how much noise you can make, and your discovery requirements, different tools, and options are available.\nInternal Passive Passive discovery relies on monitoring network layer traffic to detect network topology, services, and applications. The process does not generate any network traffic.\nAlthough is a slow process compared to an active scan and unreliable for service enumeration, as no packets are injected in the network, there is no risk of unintentional service disruption. Giving the advantage of being able to find intermittently offered or protected services that are often missed by active scanning. 1\nnetdiscover - ARP 2 sudo netdiscover -p  -p: passive mode. It does not send anything, but does only sniff.  p0f - Fingerprinting 3 sudo p0f -p  -p: promiscuous mode; by default, it listens only to packet addressed or routed through.\nOn IP-enabled interfaces can be detected remotely.  Active In contrast, active discovery does inject a variety of packets into the network, making it well suited for open port discovery and fingerprinting. However, these techniques are not without drawbacks. Scans can be invasive, generate too much noise and, in some cases cause service interruptions due to the type of packets that may be sent.\nnetdiscover - ARP 2 sudo netdiscover -r 10.0.0.0/24  -r \u0026lt;range\u0026gt;: scan a given range instead of auto scan.  Nmap nmap -sn 10.0.0.0/24  -sn: No port scan AKA ping scan. 4 Consists of an ICMP echo request, TCP SYN to port 443, TCP ACK to port 80, and an ICMP timestamp request by default.  nbtscan - NetBIOS 5 sudo nbtscan 10.0.0.0/24 ICMP Refer to External ICMP Scanning\nExternal ICMP As defined in RFC 792, ICMP messages are typically used for diagnostic or control purposes or generated in response to errors in IP operations (as specified in RFC 1122).6\nAlthough it is possible to use ICMP requests to discover if a host is up or not, it is common to find all these packets being filtered, making it an unreliable method.\nping ping -c 1 10.0.0.1  -c \u0026lt;count\u0026gt;: stops after count replies.  fping 7 fping -g 10.10.0.0/24  -g, --generate \u0026lt;target\u0026gt;: generates target list. target can be start and end IP or a CIDR address.  Nmap nmap -PEPM -sn -n 10.0.0.0/24   Parameters   -PE; -PP; -PM: ICMP echo, timestamp, and netmask request discovery probes. -sn: No port scan. -n: No DNS resolution.   Port Discovery Another commonly used technique is port scanning. It allows you to identify running services, consequently, interesting hosts. See Port Scanning.\nReference   Whyte, David. Network Scanning Detection Strategies for Enterprise Networks. Sept. 2008, pp. 12-22 https://pdfs.semanticscholar.org/bb60/dc6cf24ea1f17126511e0998d3c55bdd50f9.pdf. \u0026#x21a9;\u0026#xfe0e;\n “GitHub - Netdiscover-Scanner/Netdiscover: Netdiscover, ARP Scanner (Official Repository).” GitHub, https://github.com/netdiscover-scanner/netdiscover. \u0026#x21a9;\u0026#xfe0e;\n Zalewski, Michal. “P0f V3.” [Lcamtuf.Coredump.Cx], https://lcamtuf.coredump.cx/p0f3/. \u0026#x21a9;\u0026#xfe0e;\n “Host Discovery | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, https://nmap.org/book/man-host-discovery.html. \u0026#x21a9;\u0026#xfe0e;\n “NETBIOS Nameserver Scanner.” Steve Friedl’s Home Page, http://www.unixwiz.net/tools/nbtscan.html. \u0026#x21a9;\u0026#xfe0e;\n Forouzan, Behrouz A. Data Communications and Networking. Huga Media, 2007, pp. 621–630. \u0026#x21a9;\u0026#xfe0e;\n Schweikert, David. “Fping.” Fping Homepage, https://fping.org/. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':5,'href':'/notebook/discovery-and-scanning/port-scanning/','title':"Port Scanning",'content':"Port Scanning Let\u0026rsquo;s continue narrowing down our attack vector. It is time now to grab your host or list of hosts and scan for open ports and running services.\nPort scanners can be categorized between synchronous or connection-oriented and asynchronous or connectionless.\nSynchronous scanners, like Nmap, wait for a host response (until the timeout period expires) to determine if the port it\u0026rsquo;s alive. This translates to slower scans, especially on big network ranges, but an accurate port discovery in comparison with connectionless scanners.\nAsynchronous scanners like scanrad, zmap, or masscan, on the other hand, don\u0026rsquo;t wait for a host response as they create separate threads for each port. This allows a high-speed scan, but less accurate since they cannot detect dropped packets.\nCombining both tools could help you find a balance between speed and accuracy for each engagement. 1\nNetwork Sweep masscan 2 sudo masscan -p 7,9,13,21-23,25-26,37,53,79-81,88,106,110-111,113,119,135,139,143-144,179,199,389,427,443-445,465,513-515,543-544,548,554,587,631,646,873,990,993,995,1025-1029,1110,1433,1720,1723,1755,1900,2000-2001,2049,2121,2717,3000,3128,3306,3389,3986,4899,5000,5009,5051,5060,5101,5190,5357,5432,5631,5666,5800,5900,6000-6001,6646,7070,8000,8008-8009,8080-8081,8443,8888,9100,9999-10000,32768,49152-49157 --rate 50000 --wait 0 --open-only -oG masscan.gnmap 10.0.0.0/24   Parameters   -p \u0026lt;ports\u0026gt;: port(s) to be scanned. --rate \u0026lt;rate\u0026gt;: rate for transmitting packets (packet per seconds). --wait \u0026lt;seconds\u0026gt;: seconds after transmit is done to wait for receiving packets before exiting. Default 10 seconds. --open-only: report only open ports. -oG \u0026lt;filename\u0026gt;: output scan in grepable format to the given filename.   Host Scan TCP Scan This is a good all-purpose initial scan. Scans the most common 1000 ports with service information (-sV), default scripts (-sC), and OS detection.\nVerbose mode (-v) not only provides the estimated time for each host, but, it also prints the results as it goes letting you continue with the reconnaissance while scanning.  sudo nmap -v -sV -sC -O -T4 -n -Pn -oA nmap_scan 10.0.0.3 Similar scan but scans all ports, from 1 through 65535.\nsudo nmap -v -sV -sC -O -T4 -n -Pn -p- -oA nmap_fullscan 10.0.0.3 UDP Scan During a UDP scan (-Su) -sV will send protocol-specific probes, also known as nmap-service-probes, to every open|filtered port. In case of response the state change to open. 3\nsudo nmap -sU -sV --version-intensity 0 -n 10.0.0.0/24 Enumeration Scan In addition to the default scripts that run with -sC or --script=default, NSE (Nmap Scripting Engine), provides multiple types and categories to select from.\nIt is a common practice to combine the list of ports resulting from a network sweep or a fast nmap scan like:\nnmap -T4 -Pn -n 10.0.0.3 with a more extensive scan against those ports.\nsudo nmap -v -sV -O --script=\u0026#34;safe and vuln\u0026#34; -T4 -n -Pn -p135,445 -oA nmap_scan 10.0.0.3 The --script parameter is extremely flexible and full features, refer to the documentation for more about NSE.\nNever run scripts from third parties unless you trust the authors or have carefully audited the scripts yourself.   Parameters   -v: verbose mode. -sU: UDP scan. -sV: determine service/version info. -sC: performs a script scan. -O: enable OS detection. -p \u0026lt;port ranges\u0026gt;: scan specific ports. --open: only show open ports. -Pn: no ping. -n: no DNS resolution. -T\u0026lt;0-5\u0026gt;: timing template. oX \u0026lt;filename\u0026gt;: output scan in XML format to the given filename. --version-intensity 0: try only the probes most likely to be effective.   Miscellaneous List all Nmap scripts categories grep -r categories /usr/share/nmap/scripts/*.nse | grep -oP \u0026#39;\u0026#34;.*?\u0026#34;\u0026#39; | sort -u List Nmap scripts for a specific category List scripts under the default category.\ngrep -r categories /usr/share/nmap/scripts/*.nse | grep default | cut -d: -f1 Reference   Capt. Meelo. “Finding the Balance Between Speed \u0026amp; Accuracy During an Internet-Wide Port Scanning - Hack.Learn.Share.” Hack.Learn.Share, 29 July 2019, https://captmeelo.com/pentest/2019/07/29/port-scanning.html. \u0026#x21a9;\u0026#xfe0e;\n Graham, Robert David. “GitHub - Robertdavidgraham/Masscan: TCP Port Scanner.” GitHub, https://github.com/robertdavidgraham/masscan. \u0026#x21a9;\u0026#xfe0e;\n “UDP Scan (-SU) | Nmap Network Scanning.” Nmap: The Network Mapper - Free Security Scanner, https://nmap.org/book/scan-methods-udp-scan.html. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':6,'href':'/notebook/enumeration/smb/','title':"SMB - 139 / 445",'content':"SMB is a network communication protocol for providing shared access to files, printers, and serial ports between nodes on a network. It also provides an authenticated IPC (inter-process communication) mechanism.1\nWindows SMB Ports and Protocols TL;DR\n Port 139: SMB over NBT (NetBIOS over TCP/IP). port 445: SMB directly over TCP/IP.   Originally, in Windows NT, SMB ran on top of NBT (NetBIOS over TCP/IP), which uses ports UDP 137 and 138, and TCP 139. With Windows 2000, was introduced the option to run \u0026ldquo;NetBIOS-less\u0026rdquo; SMB directly over TCP/IP, without the extra NBT layer on port 445.\nOlder versions of Windows (with NBT enabled) will try to connect to both port 139 and 445 simultaneously, while in newer versions, port 139 is a fall-back port, as clients will try to connect to port 445 by default.2\nSMB Host Discovery Refer to host discovert with nbtscan.\nServer Version Metasploit SMB Auxiliary Module 3 msf\u0026gt; use auxiliary/scanner/smb/smb_version msf\u0026gt; set rhost 10.0.0.3 msf\u0026gt; run SMB Exploits Search Refer to Exploits Search\nCommon Login Credentials Backup and Management software requires dedicated user accounts on the server or local machine to function, and are often set with a weak password. 4\n   Usernmae Password     (blank) (blank)   Administrator admin guest (blank) admin password   arcserve arcserve backup   tivoli tivoli   backupexec backupexec backup   test test    List Shares Look for available shares using default credentials.\nsmbclient 5 smbclient --no-pass -L //10.0.0.3   Parameters   --no-pass: remove the password prompt from the client to the user. -L: list services available on the server.   Reference   Contributors to Wikimedia projects. “Server Message Block - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 26 Oct. 2003, https://en.wikipedia.org/wiki/Server_Message_Block. \u0026#x21a9;\u0026#xfe0e;\n “The Use of TCP Ports 139 and 445 in Windows.” Vidstrom Labs, https://vidstromlabs.com/blog/the-use-of-tcp-ports-139-and-445-in-windows/. \u0026#x21a9;\u0026#xfe0e;\n “Scanner SMB Auxiliary Modules - Metasploit Unleashed.” Infosec Training and Penetration Testing | Offensive Security, https://www.offensive-security.com/metasploit-unleashed/scanner-smb-auxiliary-modules/. \u0026#x21a9;\u0026#xfe0e;\n McNab, Chris. Network Security Assessment. “O’Reilly Media, Inc.,” 2007, p. 281. \u0026#x21a9;\u0026#xfe0e;\n “Smbclient.” Samba - Opening Windows to a Wider World, https://www.samba.org/samba/docs/current/man-html/smbclient.1.html. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':7,'href':'/notebook/exploits-search/','title':"Exploits Search",'content':"Exploits Search Offline searchsploit 1 Periodically update the database with searchsploit -u.  Search vulnerabilities based on a Nmap\u0026rsquo;s XML result.\nsearchsploit --nmap nmap.xml Basic search and copy the exploit the current directory.\nFor more examples, see the manual.\nsearchsploit afd windows local searchsploit -m 39446   Parameters   -u: Check for and install any exploitdb package updates. -m: Copies an exploit to the current working directory. --nmap \u0026lt;xml file\u0026gt;: Checks all results in Nmap\u0026rsquo;s XML output with service version.   MSFConsole 2 For more options, see the manual.\nmsf\u0026gt; search cve:2011 port:135 platform:windows target:XP   Search Keywords   app: Modules that are client or server attacks author: Modules written by this author bid: Modules with a matching Bugtraq ID cve: Modules with a matching CVE ID edb: Modules with a matching Exploit-DB ID name: Modules with a matching descriptive name platform: Modules affecting this platform ref: Modules with a matching ref type: Modules of a specific type (exploit, auxiliary, or post)   Online  Google: \u0026lt;service\u0026gt; \u0026lt;version\u0026gt; exploit Exploit Database Rapid7 Vulnerability \u0026amp; Exploit Database  Vulners Database Sploitus Shodan Exploits PacketStorm  Reference   “Exploit Database SearchSploit Manual.” Exploit Database - Exploits for Penetration Testers, Researchers, and Ethical Hackers, https://www.exploit-db.com/searchsploit. \u0026#x21a9;\u0026#xfe0e;\n “Msfconsole - Metasploit Unleashed.” Infosec Training and Penetration Testing | Offensive Security, https://www.offensive-security.com/metasploit-unleashed/msfconsole/. \u0026#x21a9;\u0026#xfe0e;\n   "});index.add({'id':8,'href':'/notebook/enumeration/','title':"Enumeration",'content':"Service Enumeration "});index.add({'id':9,'href':'/notebook/exploitation/','title':"Exploitation",'content':""});index.add({'id':10,'href':'/notebook/notes/','title':"Notes",'content':""});index.add({'id':11,'href':'/notebook/notes/smb-protocol-negotiation-failed/','title':"SMB Protocol Negotiation Failed",'content':"SMB Protocol Negotiation Failed Normally SMB takes care of choosing the appropriate protocol for each connection. However, if the offered protocols are out of client\u0026rsquo;s default range, it will return an error message like this:\nProtocol negotiation failed: NT_STATUS_IO_TIMEOUT Solution Edit the connection protocol range in the client configuration file.\nAdd client min protocol and client max protocol settings to /etc/samba/smb.conf under [global].\n# /etc/samba/smb.conf [global] client min protocol = CORE client max protocol = SMB3 "});index.add({'id':12,'href':'/notebook/notes/ssh-legacy-key-exchange/','title':"SSH Legacy Key Exchange",'content':"SSH Legacy Key Exchange Algorithm1 When an SSH client connects to a server, each side offers sets of connection parameters to the other. For a successful connection, there must be at least one mutually compatible set for each parameter.\nIf the client and the server cannot agree on a mutual set, in this case, the key exchange algorithm, the connection will fail and OpenSSH will return an error message like this:\nUnable to negotiate with 10.10.10.7 port 22: no matching key exchange method found. Their offer: diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1 The server offered diffie-hellman-group-exchange-sha1,diffie-hellman-group14-sha1,diffie-hellman-group1-sha1. OpenSSH supports these methods but does not enable it by default because is weak and within the theoretical range of the so-called Logjam attack.\nMore about the Logjam attack in Imperfect Forward Secrecy:How Diffie-Hellman Fails in Practice.\nSolution If upgrading is not immediately possible you can re-enable the algorithms either on the command-line:\nssh -oKexAlgorithms=+diffie-hellman-group1-sha1 root@10.10.10.7 or in the ~/.ssh/config file:\nHost 10.10.10.7 KexAlgorithms +diffie-hellman-group1-sha1 Reference   “OpenSSH: Legacy Options.” OpenSSH, https://www.openssh.com/legacy.html. \u0026#x21a9;\u0026#xfe0e;\n   "});})();