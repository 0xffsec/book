<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="DNS (Domain Name Systems) Enumeration for Pentesting"><meta property="og:title" content="DNS - 53"><meta property="og:description" content="DNS (Domain Name Systems) Enumeration for Pentesting"><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/book/services/dns/"><meta property="article:modified_time" content="2020-07-16T18:04:52+02:00"><title>DNS - 53 | 0xffsec Penetration Testing Book</title><link rel=icon href=/book/favicon.png type=image/x-icon><link rel=stylesheet href=/book/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA+eA0kDHPqIYF+1eU="><script defer src=/book/en.search.min.77feb9b30f6049dbbbe0b84bc22fce4996eefdb6e238d285f58d2a140bebf5dd.js integrity="sha256-d/65sw9gSdu74LhLwi/OSZbu/bbiONKF9Y0qFAvr9d0="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/book><span>0xffsec Penetration Testing Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/book/preface/>Preface</a></li><li><span>Discovery and Scanning</span><ul><li><a href=/book/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=/book/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=/book/exploits-search/>Exploits Search</a></li><li><a href=/book/services/>Services</a><ul><li><a href=/book/services/ftp/>FTP - 21</a></li><li><a href=/book/services/dns/ class=active>DNS - 53</a></li><li><a href=/book/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=/book/services/smb/>SMB - 139 / 445</a></li></ul></li><li><span>Web Applications</span><ul><li><a href=/book/web-applications/cgi/>CGI</a></li><li><a href=/book/web-applications/file-inclusion-and-path-traversal/>File Inclusion</a></li></ul></li><li><a href=/book/reverse-shells/>Reverse Shells</a></li><li><a href=/book/notes/ class=collapsed>Notes</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/book/svg/menu.svg class=book-icon alt=Menu></label>
<strong>DNS - 53</strong>
<label for=toc-control><img src=/book/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#ftp-exploits-search>FTP Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1>DNS</h1><blockquote class="book-hint warning">Domain Name Systems.</br><strong>Default Port: 53</strong></blockquote><p>The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network.<br>It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=tcp-and-udp>TCP and UDP</h2><p>By default, DNS uses UDP on port 53 to serve requests. When the size of the request, or the response, exceeds the single packet size of 512 bytes, the query is re-sent using TCP. Multiple records responses, IPv6 responses, big TXT records, DNSSEC responses, and <strong>zone transfers</strong> are some examples of these requests.</p><blockquote class="book-hint warning">When DNS is running on TCP, it is worth checking if <a href=#zone-transfer>zone trasfer</a> is enabled.</blockquote><h2 id=banner-grabbing>Banner Grabbing</h2><p>DNS does not provide an information banner <em>per se</em> but BIND DNS exposes its version by default. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><blockquote class="book-hint info">The <code>version.bind</code> directive is stored under the <code>options</code> section in the <code>/etc/named.conf</code> configuration file.</blockquote><h4 id=dig>dig</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig version.bind CHAOS TXT @10.0.0.3
</code></pre></div><h4 id=dns-nsidhttpsnmaporgnsedocscriptsdns-nsidhtml-nse-script><a href=https://nmap.org/nsedoc/scripts/dns-nsid.html>dns-nsid</a> NSE Script</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sV --script dns-nsid -p53 -Pn 10.0.0.3
</code></pre></div><h2 id=ftp-exploits-search>FTP Exploits Search</h2><p>Refer to <a href=https://0xffsec.com/book/exploits-search/>Exploits Search</a></p><h2 id=zone-transfer>Zone Transfer</h2><p>DNS reconnaissance is especially valuable during the information gathering stage since it could reveal crucial information about the domain and the infrastructure. But it can also reveal new attack vectors, for example, if Virtual Routing is enabled.</p><p>A zone transfer is the process where a DNS server, usually a Master server, passes a copy of a <strong>zone</strong> to another DNS server, usually a Slave server. Ideally, these transfers are limited to certain IPs, but misconfigured servers allow these transfers to anyone <em>asking</em> for them.</p><h3 id=dig-1>dig</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig axfr @10.0.0.3 domain
</code></pre></div><details><summary>Parameters</summary><ul><li><code>axfr</code>: initiate an <em>AXFR</em> zone transfer query.</li><li><code>@10.0.0.3</code>: name or IP of the server to query.</li><li><code>domain</code>: name of the resource record that is to be looked up.</li></ul></details><blockquote class="book-hint info">It is worth trying to initiate a zone transfer without a domain.</blockquote><h2 id=configuration-files>Configuration files</h2><p>Examine configuration files.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><pre><code>host.conf
resolv.conf
named.conf
</code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://www.sans.org/reading-room/whitepapers/dns/securing-dns-zone-transfer-868>SANS Securing DNS Zone Transfer</a></li><li><a href=https://blog.ted.com/what-the-internet-looked-like-in-1982-a-closer-look-at-danny-hillis-vintage-directory-of-users/>What the internet looke like in 1982</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Contributors to Wikimedia projects. “Domain Name System - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 20 Aug. 2001, <a href=https://en.wikipedia.org/wiki/Domain_Name_System>https://en.wikipedia.org/wiki/Domain_Name_System</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“Determining BIND DNS Version Using Dig.” OSI Security - Penetration Testing & Web Application Security Consultants, <a href=https://www.osi.security/blog/determining-bind-dns-version-using-dig>https://www.osi.security/blog/determining-bind-dns-version-using-dig</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“Penetration Testing Methodology” 0DAYsecurity.Com, <a href=http://www.0daysecurity.com/penetration-testing/enumeration.html>http://www.0daysecurity.com/penetration-testing/enumeration.html</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/book/commit/efe1d6d0682a601b0addd749bca6a116c04c45fe title="Last modified by Max Rodrigo | July 16, 2020" target=_blank rel=noopener><img src=/book/svg/calendar.svg class=book-icon alt=Calendar>
<span>July 16, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/book/edit/master/content//services/dns.md target=_blank rel=noopener><img src=/book/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#ftp-exploits-search>FTP Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></main></body></html>