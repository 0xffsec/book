<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="DNS (Domain Name Systems) At a Glance  Default Port: 53  The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network. It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="DNS (Domain Name Systems) Service Enumeration"><meta property="og:description" content="DNS (Domain Name Systems) At a Glance  Default Port: 53  The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network. It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/handbook/services/dns/"><meta property="og:image" content="https://0xffsec.com/handbook/images/banner.png"><meta property="article:modified_time" content="2020-11-02T09:32:04+01:00"><meta itemprop=name content="DNS (Domain Name Systems) Service Enumeration"><meta itemprop=description content="DNS (Domain Name Systems) At a Glance  Default Port: 53  The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network. It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols."><meta itemprop=dateModified content="2020-11-02T09:32:04+01:00"><meta itemprop=wordCount content="403"><meta itemprop=image content="https://0xffsec.com/handbook/images/banner.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xffsec.com/handbook/images/banner.png"><meta name=twitter:title content="DNS (Domain Name Systems) Service Enumeration"><meta name=twitter:description content="DNS (Domain Name Systems) At a Glance  Default Port: 53  The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network. It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols."><title>DNS (Domain Name Systems) Service Enumeration | 0xffsec Handbook</title><link rel=manifest href=https://0xffsec.com/handbook/manifest.json><link rel=icon href=https://0xffsec.com/handbook/favicon.png type=image/x-icon><link rel=stylesheet href=https://0xffsec.com/handbook/book.min.e255ce8e6eb0178448221a1dc94dd9d0ef7eb15ed1335794b0b7e6a4014b4229.css integrity="sha256-4lXOjm6wF4RIIhodyU3Z0O9+sV7RM1eUsLfmpAFLQik="><script defer src=https://0xffsec.com/handbook/en.search.min.32d85748f002120eb428047719414ab9dbae5a5d9c04113bfe243e2096ac6241.js integrity="sha256-MthXSPACEg60KAR3GUFKuduuWl2cBBE7/iQ+IJasYkE="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://0xffsec.com/handbook/><img src=https://0xffsec.com/handbook/images/logo.png alt=Logo><span>0xffsec Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-35d81374824c25dc2919edbbc61d971f class=toggle>
<label for=section-35d81374824c25dc2919edbbc61d971f class="flex justify-between"><a>Information Gathering</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/information-gathering/assets-discovery/>Assets Discovery</a></li><li><a href=https://0xffsec.com/handbook/information-gathering/subdomain-enumeration/>Subdomain Enumeration</a></li></ul></li><li><input type=checkbox id=section-235f64cfc2023c9b7289c228d0c51f53 class=toggle>
<label for=section-235f64cfc2023c9b7289c228d0c51f53 class="flex justify-between"><a>Discovery and Scanning</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exploits-search/>Exploit Search</a></li><li><a href=https://0xffsec.com/handbook/brute-forcing/>Brute Forcing</a></li><li><input type=checkbox id=section-057108a1c1a3662b9db6ab679412fa8f class=toggle checked>
<label for=section-057108a1c1a3662b9db6ab679412fa8f class="flex justify-between"><a href=https://0xffsec.com/handbook/services/>Service Enumeration</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/services/ftp/>FTP - 21</a></li><li><a href=https://0xffsec.com/handbook/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=https://0xffsec.com/handbook/services/dns/ class=active>DNS - 53</a></li><li><a href=https://0xffsec.com/handbook/services/finger/>Finger - 79</a></li><li><a href=https://0xffsec.com/handbook/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=https://0xffsec.com/handbook/services/pop/>POP - 110 / 995</a></li><li><a href=https://0xffsec.com/handbook/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=https://0xffsec.com/handbook/services/msrpc/>MSRPC - 135 / 593</a></li><li><a href=https://0xffsec.com/handbook/services/netbios/>NetBIOS - 137 / 138 / 139</a></li><li><a href=https://0xffsec.com/handbook/services/smb/>SMB - 139 / 445</a></li><li><a href=https://0xffsec.com/handbook/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=https://0xffsec.com/handbook/steganography/>Steganography</a></li><li><input type=checkbox id=section-4710461fd82136af748c8186e2a511e1 class=toggle>
<label for=section-4710461fd82136af748c8186e2a511e1 class="flex justify-between"><a>Web Applications</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/web-applications/cgi/>CGI</a></li><li><a href=https://0xffsec.com/handbook/web-applications/command-injection/>Command Injection</a></li><li><a href=https://0xffsec.com/handbook/web-applications/csrf/>CSRF</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/>LFI / RFI and Path Traversal</a></li></ul></li><li><input type=checkbox id=section-9b274a52224e37b079acf4aae5f9f128 class=toggle>
<label for=section-9b274a52224e37b079acf4aae5f9f128 class="flex justify-between"><a>Shells</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/shells/reverse-shells/>Reverse Shells</a></li><li><a href=https://0xffsec.com/handbook/shells/full-tty/>Upgrade to Full TTY</a></li><li><a href=https://0xffsec.com/handbook/shells/restricted-shells/>Escape Restricted Shells</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exfiltration/>Data Exfiltration</a></li><li><input type=checkbox id=section-ef46fe0aac274900fefdd5e564e236b2 class=toggle>
<label for=section-ef46fe0aac274900fefdd5e564e236b2 class="flex justify-between"><a href=https://0xffsec.com/handbook/notes/>Notes</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/notes/how-to-open-jar-files/>JAR Files</a></li><li><a href=https://0xffsec.com/handbook/notes/smb-protocol-negotiation-failed/>SMB Protocol Negotiation Failed</a></li><li><a href=https://0xffsec.com/handbook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li><li><a href=https://0xffsec.com/handbook/further-reading/>Further Reading</a></li></ul><ul><li><a href=https://github.com/0xffsec/handbook target=_blank rel=noopener>GitHub</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://0xffsec.com/handbook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>DNS (Domain Name Systems) Service Enumeration</strong>
<label for=toc-control><img src=https://0xffsec.com/handbook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#dns-exploits-search>DNS Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1 id=dns-domain-name-systems>DNS (Domain Name Systems)</h1><h2 id=at-a-glance>At a Glance</h2><div class=book-highlight><p><strong>Default Port:</strong> 53</p></div><p>The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network.
It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=tcp-and-udp>TCP and UDP</h2><p>By default, DNS uses UDP on port 53 to serve requests. When the size of the request, or the response, exceeds the single packet size of 512 bytes, the query is re-sent using TCP. Multiple records responses, IPv6 responses, big TXT records, DNSSEC responses, and <strong>zone transfers</strong> are some examples of these requests.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
When DNS is running on TCP, it is worth checking if <a href=#zone-transfer>zone trasfer</a> is enabled.</p></div></div><h2 id=banner-grabbing>Banner Grabbing</h2><p>DNS does not provide an information banner <em>per se</em> but BIND DNS exposes its version by default. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
The <code>version.bind</code> directive is stored under the <code>options</code> section in the <code>/etc/named.conf</code> configuration file.</p></div></div><h4 id=dig>dig</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig version.bind CHAOS TXT @10.0.0.3
</code></pre></div><h4 id=dns-nsidhttpsnmaporgnsedocscriptsdns-nsidhtml-nse-script><a href=https://nmap.org/nsedoc/scripts/dns-nsid.html>dns-nsid</a> NSE Script</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sV --script dns-nsid -p53 -Pn 10.0.0.3
</code></pre></div><h2 id=dns-exploits-search>DNS Exploits Search</h2><p>Refer to <a href=https://0xffsec.com/handbook/exploits-search/>Exploits Search</a></p><h2 id=zone-transfer>Zone Transfer</h2><p>DNS reconnaissance is especially valuable during the information gathering stage since it could reveal crucial information about the domain and the infrastructure. But it can also reveal new attack vectors, for example, if Virtual Routing is enabled.</p><p>A zone transfer is the process where a DNS server, usually a Master server, passes a copy of a <strong>zone</strong> to another DNS server, usually a Slave server. Ideally, these transfers are limited to certain IPs, but misconfigured servers allow these transfers to anyone <em>asking</em> for them.</p><h3 id=dig-1>dig</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig axfr @10.0.0.3 domain
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>axfr</code>: initiate an <em>AXFR</em> zone transfer query.</li><li><code>@10.0.0.3</code>: name or IP of the server to query.</li><li><code>domain</code>: name of the resource record that is to be looked up.</li></ul></div></details><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
It is worth trying to initiate a zone transfer without a domain.</p></div></div><h2 id=configuration-files>Configuration files</h2><p>Examine configuration files.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><pre><code>host.conf
resolv.conf
named.conf
</code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://www.sans.org/reading-room/whitepapers/dns/securing-dns-zone-transfer-868>SANS Securing DNS Zone Transfer</a></li><li><a href=https://blog.ted.com/what-the-internet-looked-like-in-1982-a-closer-look-at-danny-hillis-vintage-directory-of-users/>What the internet looke like in 1982</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Contributors to Wikimedia projects. “Domain Name System - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 20 Aug. 2001, <a href=https://en.wikipedia.org/wiki/Domain_Name_System>https://en.wikipedia.org/wiki/Domain_Name_System</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“Determining BIND DNS Version Using Dig.” OSI Security - Penetration Testing & Web Application Security Consultants, <a href=https://www.osi.security/blog/determining-bind-dns-version-using-dig>https://www.osi.security/blog/determining-bind-dns-version-using-dig</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“Penetration Testing Methodology” 0DAYsecurity.Com, <a href=http://www.0daysecurity.com/penetration-testing/enumeration.html>http://www.0daysecurity.com/penetration-testing/enumeration.html</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/commit/bb97ec8cc65bfec105f739cbbd7324f633787bcc title="Last modified by Max Rodrigo | November 2, 2020" target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/calendar.svg class=book-icon alt=Calendar>
<span>November 2, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/edit/master/content//services/dns.md target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#dns-exploits-search>DNS Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></main></body></html>