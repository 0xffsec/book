<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="DNS (Domain Name Systems) Enumeration for Pentesting"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="DNS - 53"><meta property="og:description" content="DNS (Domain Name Systems) Enumeration for Pentesting"><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/handbook/services/dns/"><meta property="article:modified_time" content="2020-09-28T00:55:27+02:00"><title>DNS - 53 | 0xffsec Pentesting Handbook</title><link rel=manifest href=https://0xffsec.com/handbook/manifest.json><link rel=icon href=https://0xffsec.com/handbook/favicon.png type=image/x-icon><link rel=stylesheet href=https://0xffsec.com/handbook/book.min.69f176da870848b66bea186407dfa6368003f9e728dd20b1284eb6d2abc89bdc.css integrity="sha256-afF22ocISLZr6hhkB9+mNoAD+eco3SCxKE620qvIm9w="><script defer src=https://0xffsec.com/handbook/en.search.min.65672dcf246414e4a4c1710abc9b1bc448dbedb3a0418d391ceaf87bafdc75b1.js integrity="sha256-ZWctzyRkFOSkwXEKvJsbxEjb7bOgQY05HOr4e6/cdbE="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://0xffsec.com/handbook/><img src=https://0xffsec.com/handbook/images/logo.png alt=Logo><span>0xffsec Pentesting Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Discovery and Scanning</span><ul><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exploits-search/>Exploits Search</a></li><li><a href=https://0xffsec.com/handbook/brute-forcing/>Brute Forcing</a></li><li><a href=https://0xffsec.com/handbook/services/>Services</a><ul><li><a href=https://0xffsec.com/handbook/services/ftp/>FTP - 21</a></li><li><a href=https://0xffsec.com/handbook/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=https://0xffsec.com/handbook/services/dns/ class=active>DNS - 53</a></li><li><a href=https://0xffsec.com/handbook/services/finger/>Finger - 79</a></li><li><a href=https://0xffsec.com/handbook/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=https://0xffsec.com/handbook/services/pop/>POP - 110 / 995</a></li><li><a href=https://0xffsec.com/handbook/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=https://0xffsec.com/handbook/services/msrpc/>MSRPC - 135 / 593</a></li><li><a href=https://0xffsec.com/handbook/services/netbios/>NetBIOS - 137 / 138 / 139</a></li><li><a href=https://0xffsec.com/handbook/services/smb/>SMB - 139 / 445</a></li><li><a href=https://0xffsec.com/handbook/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=https://0xffsec.com/handbook/steganography/>Steganography</a></li><li><span>Web Applications</span><ul><li><a href=https://0xffsec.com/handbook/web-applications/cgi/>CGI</a></li><li><a href=https://0xffsec.com/handbook/web-applications/command-injection/>Command Injection</a></li><li><a href=https://0xffsec.com/handbook/web-applications/csrf/>CSRF - Cross-Site Request Forgery</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/>File Inclusion</a></li></ul></li><li><span>Shells</span><ul><li><a href=https://0xffsec.com/handbook/shells/full-tty/>Full TTY</a></li><li><a href=https://0xffsec.com/handbook/shells/reverse-shells/>Reverse Shells</a></li><li><a href=https://0xffsec.com/handbook/shells/restricted-shells/>Restricted Shells</a></li></ul></li><li><input type=checkbox id=section-ef46fe0aac274900fefdd5e564e236b2 class=toggle>
<label for=section-ef46fe0aac274900fefdd5e564e236b2 class="flex justify-between"><a href=https://0xffsec.com/handbook/notes/>Notes</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/notes/how-to-open-jar-files/>How to Open JAR files</a></li><li><a href=https://0xffsec.com/handbook/notes/smb-protocol-negotiation-failed/>SMB Protocol Negotiation Failed</a></li><li><a href=https://0xffsec.com/handbook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://0xffsec.com/handbook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>DNS - 53</strong>
<label for=toc-control><img src=https://0xffsec.com/handbook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#dns-exploits-search>DNS Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1 id=dns>DNS</h1><blockquote class="book-hint info"><p>Domain Name Systems.</p><p><strong>Default Port:</strong> 53</p></blockquote><p>The Domain Name System (DNS) is a hierarchical and decentralized naming system for computers, services, and other resources connected to a network.
It associates different information with domain names assigned to each of the participating entities. Most prominently, it translates more easily memorized domain names to the numerical IP addresses needed for identifying computer services and devices with the underlying network protocols. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=tcp-and-udp>TCP and UDP</h2><p>By default, DNS uses UDP on port 53 to serve requests. When the size of the request, or the response, exceeds the single packet size of 512 bytes, the query is re-sent using TCP. Multiple records responses, IPv6 responses, big TXT records, DNSSEC responses, and <strong>zone transfers</strong> are some examples of these requests.</p><blockquote class="book-hint warning">When DNS is running on TCP, it is worth checking if <a href=#zone-transfer>zone trasfer</a> is enabled.</blockquote><h2 id=banner-grabbing>Banner Grabbing</h2><p>DNS does not provide an information banner <em>per se</em> but BIND DNS exposes its version by default. <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><blockquote class="book-hint info">The <code>version.bind</code> directive is stored under the <code>options</code> section in the <code>/etc/named.conf</code> configuration file.</blockquote><h4 id=dig>dig</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig version.bind CHAOS TXT @10.0.0.3
</code></pre></div><h4 id=dns-nsidhttpsnmaporgnsedocscriptsdns-nsidhtml-nse-script><a href=https://nmap.org/nsedoc/scripts/dns-nsid.html>dns-nsid</a> NSE Script</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sV --script dns-nsid -p53 -Pn 10.0.0.3
</code></pre></div><h2 id=dns-exploits-search>DNS Exploits Search</h2><p>Refer to <a href=https://0xffsec.com/handbook/exploits-search/>Exploits Search</a></p><h2 id=zone-transfer>Zone Transfer</h2><p>DNS reconnaissance is especially valuable during the information gathering stage since it could reveal crucial information about the domain and the infrastructure. But it can also reveal new attack vectors, for example, if Virtual Routing is enabled.</p><p>A zone transfer is the process where a DNS server, usually a Master server, passes a copy of a <strong>zone</strong> to another DNS server, usually a Slave server. Ideally, these transfers are limited to certain IPs, but misconfigured servers allow these transfers to anyone <em>asking</em> for them.</p><h3 id=dig-1>dig</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>dig axfr @10.0.0.3 domain
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>axfr</code>: initiate an <em>AXFR</em> zone transfer query.</li><li><code>@10.0.0.3</code>: name or IP of the server to query.</li><li><code>domain</code>: name of the resource record that is to be looked up.</li></ul></div></details><blockquote class="book-hint info">It is worth trying to initiate a zone transfer without a domain.</blockquote><h2 id=configuration-files>Configuration files</h2><p>Examine configuration files.<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><pre><code>host.conf
resolv.conf
named.conf
</code></pre><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://www.sans.org/reading-room/whitepapers/dns/securing-dns-zone-transfer-868>SANS Securing DNS Zone Transfer</a></li><li><a href=https://blog.ted.com/what-the-internet-looked-like-in-1982-a-closer-look-at-danny-hillis-vintage-directory-of-users/>What the internet looke like in 1982</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Contributors to Wikimedia projects. “Domain Name System - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 20 Aug. 2001, <a href=https://en.wikipedia.org/wiki/Domain_Name_System>https://en.wikipedia.org/wiki/Domain_Name_System</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>“Determining BIND DNS Version Using Dig.” OSI Security - Penetration Testing & Web Application Security Consultants, <a href=https://www.osi.security/blog/determining-bind-dns-version-using-dig>https://www.osi.security/blog/determining-bind-dns-version-using-dig</a>. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“Penetration Testing Methodology” 0DAYsecurity.Com, <a href=http://www.0daysecurity.com/penetration-testing/enumeration.html>http://www.0daysecurity.com/penetration-testing/enumeration.html</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/commit/302b96b1ddb2c7c2d5128831e91625fa63c4a1b0 title="Last modified by Max Rodrigo | September 27, 2020" target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/calendar.svg class=book-icon alt=Calendar>
<span>September 27, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/edit/master/content//services/dns.md target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#tcp-and-udp>TCP and UDP</a></li><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#dns-exploits-search>DNS Exploits Search</a></li><li><a href=#zone-transfer>Zone Transfer</a><ul><li><a href=#dig-1>dig</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></main></body></html>