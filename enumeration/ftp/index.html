<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="FTP (File Transfer Protocol) Enumeration for Pentesting"><meta property="og:title" content="FTP - 21"><meta property="og:description" content="FTP (File Transfer Protocol) Enumeration for Pentesting"><meta property="og:type" content="article"><meta property="og:url" content="https://0xffsec.com/notebook/enumeration/ftp/"><meta property="article:modified_time" content="2020-05-17T14:29:16+02:00"><title>FTP - 21 | Notebook</title><link rel=icon href=/notebook/favicon.png type=image/x-icon><link rel=stylesheet href=/notebook/book.min.6df681b0bb21155cba49f6078e3559216772d8e03e780d240c73ea21817ed5e5.css integrity="sha256-bfaBsLshFVy6SfYHjjVZIWdy2OA+eA0kDHPqIYF+1eU="><script defer src=/notebook/en.search.min.f8da1ea5b014a73e131bf5589fe2f1347abc5c4a72d787ec39e31633e5169c37.js integrity="sha256-+NoepbAUpz4TG/VYn+LxNHq8XEpy14fsOeMWM+UWnDc="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/notebook><span>Notebook</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=/notebook/preface/>Preface</a></li><li><span>Discovery and Scanning</span><ul><li><a href=/notebook/discovery-and-scanning/host-discovery/>Host Discovery</a></li><li><a href=/notebook/discovery-and-scanning/port-scanning/>Port Scanning</a></li></ul></li><li><a href=/notebook/exploits-search/>Exploits Search</a></li><li><a href=/notebook/enumeration/>Enumeration</a><ul><li><a href=/notebook/enumeration/ftp/ class=active>FTP - 21</a></li><li><a href=/notebook/enumeration/http-https/>HTTP/S - 80 / 443</a></li><li><a href=/notebook/enumeration/smb/>SMB - 139 / 445</a></li></ul></li><li><span>Exploitation</span><ul></ul></li><li><span>Notes</span><ul><li><a href=/notebook/notes/ssh-legacy-key-exchange/>SSH Legacy Key Exchange</a></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/notebook/svg/menu.svg class=book-icon alt=Menu></label>
<strong>FTP - 21</strong>
<label for=toc-control><img src=/notebook/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#ftp-exploits-search>FTP Exploits Search</a></li><li><a href=#anonymous-login>Anonymous Login</a></li><li><a href=#ftp-browser-client>FTP Browser Client</a></li><li><a href=#brute-forcing>Brute Forcing</a><ul><li><a href=#hydra-hydra>Hydra</a></li><li><a href=#medusa-medusa>Medusa</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#tools-and-tips>Tools and Tips</a><ul><li><a href=#binary-and-ascii>Binary and ASCII</a></li><li><a href=#recursively-download>Recursively Download</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1>FTP</h1><blockquote class="book-hint warning">File Transfer Protocol.</br><strong>Default Port: 21</strong></blockquote><p>FTP is a standard network protocol used for the transfer of files between a client and a server on a computer network.<br>FTP is built on a client-server architecture using separate control and data connections between the client and the server. FTP authenticates users with a clear-text sign-in protocol, normally in the form of a username and password, but can connect anonymously if the server is configured to allow it. <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=banner-grabbing>Banner Grabbing</h2><h4 id=telnet>Telnet</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>telnet 10.0.0.3 <span style=color:#bd93f9>21</span>
</code></pre></div><h4 id=netcat>Netcat</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nc -n 10.0.0.3 <span style=color:#bd93f9>21</span>
</code></pre></div><h4 id=nmap>Nmap</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>nmap -sV -script<span style=color:#ff79c6>=</span>banner -p21 -Pn 10.0.0.3
</code></pre></div><h4 id=ftp>FTP</h4><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ftp 10.0.0.3
</code></pre></div><h2 id=ftp-exploits-search>FTP Exploits Search</h2><p>Refer to <a href=https://0xffsec.com/notebook/exploits-search/>Exploits Search</a></p><h2 id=anonymous-login>Anonymous Login</h2><blockquote class="book-hint info">During the <a href=https://0xffsec.com/notebook/discovery-and-scanning/port-scanning/>port scanning</a> phase Nmap&rsquo;s script scan (<code>-sC</code>), can be enabled to check for <a href=https://nmap.org/nsedoc/scripts/ftp-bounce.html>FTP Bounce</a> and <a href=https://nmap.org/nsedoc/scripts/ftp-anon.html>Anonymous Login</a>.</blockquote><p>Try anonymous login using <code>anonymous:anonymous</code> credentials.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ftp 10.0.0.3
...
Name <span style=color:#ff79c6>(</span>10.0.0.3:kali<span style=color:#ff79c6>)</span>: anonymous
<span style=color:#bd93f9>331</span> Please specify the password.
Password: <span style=color:#ff79c6>[</span>anonymous<span style=color:#ff79c6>]</span>
<span style=color:#bd93f9>230</span> Login successful.
</code></pre></div><p>List <strong>all</strong> files in order.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>ftp&gt; ls -lat
<span style=color:#bd93f9>200</span> PORT <span style=color:#8be9fd;font-style:italic>command</span> successful. Consider using PASV.
<span style=color:#bd93f9>150</span> Here comes the directory listing.
...
<span style=color:#bd93f9>226</span> Directory send OK.
</code></pre></div><h2 id=ftp-browser-client>FTP Browser Client</h2><blockquote class="book-hint danger">Due to its insecure nature, FTP support is being dropped by <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1574475">Firefox</a> and <a href=https://chromestatus.com/feature/6246151319715840>Google Chrome</a>.</blockquote><p>Try accessing <code>ftp://user:pass@10.0.0.3</code> from your browser.<br>If not credentials provided <code>anonymous:anonymous</code> is assumed.</p><h2 id=brute-forcing>Brute Forcing</h2><p>As an alternative to profiled passwords, <a href=https://github.com/danielmiessler/SecLists>Daniel Miessler&rsquo;s SecLists</a> includes a handy list of <a href=https://github.com/danielmiessler/SecLists/blob/master/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt>FTP default credentials</a>.</p><h3 id=hydra-hydra>Hydra <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></h3><p>Using a colon-separated <code>user:pass</code> list.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>hydra -v -C /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt -f 10.0.0.3 ftp
</code></pre></div><p>Using login user and passwords list.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>hydra -v -l ftp -P /usr/share/wordlists/rockyou.txt.gz -f 10.0.0.3 ftp
</code></pre></div><details><summary>Parameters</summary><ul><li><code>-v</code>: verbose mode.</li><li><code>-C &lt;user:pass file></code>: colon-separated &ldquo;login:pass&rdquo; format.</li><li><code>-l &lt;user></code>: login with <code>user</code> name.</li><li><code>-P &lt;passwords file></code>: login with password from file.</li><li><code>-f</code>: exit after the first found user/password pair.</li></ul></details><h3 id=medusa-medusa>Medusa <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></h3><p>Medusa&rsquo;s combo files (colon-separated) should be in the format <code>host:username:password</code>. If any of the three values are missing, the respective information should be provided either as a global value or as a list in a file.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>sed s/^/:/ /usr/share/seclists/Passwords/Default-Credentials/ftp-betterdefaultpasslist.txt &gt; /tmp/cplist.txt
medusa -C /tmp/cplist.txt -h 10.0.0.3 -M ft
</code></pre></div><p>Using login user and passwords list.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>medusa -u ftp -P /usr/share/wordlists/rockyou.txt -h 10.0.0.3 -M ftp
</code></pre></div><details><summary>Parameters</summary><ul><li><code>-u &lt;user></code>: login with <code>user</code> name.</li><li><code>-P &lt;passwords file></code>: login with password from file.</li><li><code>-h</code>: target hostname or IP address.</li><li><code>-M</code>: module to execute.</li></ul></details><h2 id=configuration-files>Configuration files</h2><p>Examine configuration files.<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup></p><pre><code>ftpusers
ftp.conf
proftpd.conf
</code></pre><h2 id=tools-and-tips>Tools and Tips</h2><h3 id=binary-and-ascii>Binary and ASCII</h3><p>Binary and ASCII files have to be uploading using the <code>binary</code> or <code>ascii</code> mode respectively, otherwise, the file will become corrupted. Use the corresponding command to switch between modes.<sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup></p><h3 id=recursively-download>Recursively Download</h3><p>Recursively download FTP folder content.<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup></p><div class=highlight><pre style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh>wget -m ftp://user:pass@10.0.0.3/
</code></pre></div><h1 id=reference>Reference</h1><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Contributors to Wikimedia projects. “File Transfer Protocol - Wikipedia.” Wikipedia, the Free Encyclopedia, Wikimedia Foundation, Inc., 24 May 2002, <a href=https://en.wikipedia.org/wiki/File_Transfer_Protocol>https://en.wikipedia.org/wiki/File_Transfer_Protocol</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Heuse, Marc. “GitHub - Vanhauser-Thc/Thc-Hydra: Hydra.” GitHub, <a href=https://github.com/vanhauser-thc/thc-hydra>https://github.com/vanhauser-thc/thc-hydra</a>. Accessed 12 May 2020. <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>“Foofus Networking Services - Medusa.” Foofus.Net | Foofus.Net Advanced Security Services Forum, <a href=http://foofus.net/goons/jmk/medusa/medusa.html>http://foofus.net/goons/jmk/medusa/medusa.html</a>. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>“Penetration Testing Methodology” 0DAYsecurity.Com, <a href=http://www.0daysecurity.com/penetration-testing/enumeration.html>http://www.0daysecurity.com/penetration-testing/enumeration.html</a>. <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>“RFC959: FTP: Data Transfer Functions.” World Wide Web Consortium (W3C), <a href=https://www.w3.org/Protocols/rfc959/3_DataTransfer.html>https://www.w3.org/Protocols/rfc959/3_DataTransfer.html</a>. <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>Thibaut Barrère. “Command Line - How to Recursively Download a Folder via FTP on Linux - Stack Overflow.” Stack Overflow, <a href=https://stackoverflow.com/a/113900/578050>https://stackoverflow.com/a/113900/578050</a>. <a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex justify-between"><div><a class="flex align-center" href=https://github.com/0xffsec/notebook/commit/0156a497a0544425e7b2c3db723b6d5dc4778d20 title="Last modified by Max Rodrigo | May 17, 2020" target=_blank rel=noopener><img src=/notebook/svg/calendar.svg class=book-icon alt=Calendar>
<span>May 17, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/0xffsec/notebook/edit/master/content//enumeration/ftp.md target=_blank rel=noopener><img src=/notebook/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this page</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#banner-grabbing>Banner Grabbing</a><ul><li></li></ul></li><li><a href=#ftp-exploits-search>FTP Exploits Search</a></li><li><a href=#anonymous-login>Anonymous Login</a></li><li><a href=#ftp-browser-client>FTP Browser Client</a></li><li><a href=#brute-forcing>Brute Forcing</a><ul><li><a href=#hydra-hydra>Hydra</a></li><li><a href=#medusa-medusa>Medusa</a></li></ul></li><li><a href=#configuration-files>Configuration files</a></li><li><a href=#tools-and-tips>Tools and Tips</a><ul><li><a href=#binary-and-ascii>Binary and ASCII</a></li><li><a href=#recursively-download>Recursively Download</a></li></ul></li></ul></nav></aside></main></body></html>